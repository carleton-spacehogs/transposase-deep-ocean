ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
log_scale <- c("0%\nno hits", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
geom_point() +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
geom_point() +
#scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
all_p <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm") %>%
filter(!is.na(depth))
all_p <- filter_outliers(all_p, "median_bin_pnps")
all_p$depth <- fct_rev(all_p$depth)
all_p$graphing_log_trans <- ifelse(all_p$log_percent_trans < -9, -2, all_p$log_percent_trans)
all_p$graphing_log_biofilm <- ifelse(all_p$log_percent_biofilm < -9, -2, all_p$log_percent_biofilm)
color2 <- ifelse(all_p$depth=="MES","blue4",ifelse(all_p$depth=="DCM", "steelblue", "sky blue"))
scatterplot3d(all_p[,c("median_bin_pnps", "graphing_log_trans", "depth")],
angle = 23, pch = 20, # pch = all$shape3D, # type = "h", lty.hplot = 2,
lab.z = 2,
lab = c(4, 4, 1),
y.ticklabs = c("<0.01%", "0.03%", "0.1%", "0.32%", "1%"),
# scale.y = 0.5,
z.ticklabs = c("     MES", "DCM", "SRF"),
grid=TRUE, box=TRUE, color=color2)
log_scale <- c("0%\nno hits", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
geom_point() +
#scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
log_scale <- c("0%\nno hits", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
geom_point() +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
geom_point() +
# scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
scale <- c(-2, -1.5, -1, -0.5, 0)
log_scale <- c("0%\nno hits", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
geom_point() +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
# xlim(-2,15) + ylim(-0.01,0.31) +
theme_classic()
low_trans <- c("Verrucomicrobia", "Acidimicrobidae")
high_trans <- c("Alphaproteobacteria", "Betaproteobacteria", "Deltaproteobacteria",
"Gammaproteobacteria", "Sphingobacteria", "Actinobacteria")
all <- filter_outliers(bin_taxon, "percent_trans") %>%
select("complete genome size (Mbp)", "percent_trans", "log_percent_trans",
"Class with more than 10 MAGs", "depth", "Class", "percent_biofilm",
"log_percent_biofilm", "class_trans", "graphing_log_trans",
"graphing_log_biofilm") %>%
filter(!is.na(depth))
all <- all%>%  #filter_outliers(all,"complete genome size (Mbp)") %>%
mutate(size_bin=cut(`complete genome size (Mbp)`, breaks = c(0,2,3,4,5,20)))
# mutate(size_bin = cut_interval(`complete genome size (Mbp)`, 5))
all$size_bin <- as.character(all$size_bin)
all$size_bin[all$size_bin == '(0,2]'] <- '0-2'
all$size_bin[all$size_bin == '(2,3]'] <- '2-3'
all$size_bin[all$size_bin == '(3,4]'] <- '3-4'
all$size_bin[all$size_bin == '(4,5]'] <- '4-5'
all$size_bin[all$size_bin == '(5,20]'] <- '>5'
all$size_bin <- factor(all$size_bin, levels = c(">5","4-5","3-4","2-3","0-2"))
p1<-ggplot(all, aes(x=fct_rev(size_bin), y=percent_trans)) +
geom_jitter(aes(color = class_trans), alpha = 0.8) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = 0.03)) +
facet_wrap(~depth, ncol= 3) +
# labs(color='Taxonomical Classes of:') +
#coord_flip()+
ylab("%-transposase in MAG") +
xlab("complete genome size (Mbp)") +
theme_classic() +
theme(legend.position = "none")
# filter_outliers(all, "complete genome size (Mbp)")
p2<-all %>%
filter(depth %in% c("SRF", "DCM", "MES")) %>%
mutate(depth = fct_rev(depth)) %>%
ggplot(aes(x = depth, y = `complete genome size (Mbp)`)) +
# ylim(0,12.5) +
stat_compare_means(comparisons = list(c("DCM","MES"), c("SRF","MES")),
label = "p.signif", hide.ns = TRUE, method = "t.test",
label.y = c(8,9)) +
scale_color_manual(labels = c("High transposase abundance\n(\u0251- \u03b2- \u03b3- \u03b4- proteobacteria,\n Actinobactia, Sphingobactia)\n",
"Normal transposase abundance\n",
"Low transposase abundance\n(Verrucomicrobia, Acidimicrobidae)"),
values = c('orange','gray', "green"))+
labs(color='Taxonomical Class of:') +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, alpha = 0.1) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = 0.2)) +
coord_flip() +
theme_classic()
ggarrange(p1,p2,
nrow = 2,
heights = c(3/5,2/5),
labels = c("A", "B"))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
transposase_in_bins <- init_transposase_in_bins()
low_trans <- c("Verrucomicrobia", "Acidimicrobidae")
high_trans <- c("Alphaproteobacteria", "Betaproteobacteria", "Deltaproteobacteria",
"Gammaproteobacteria", "Sphingobacteria", "Actinobacteria")
all <- filter_outliers(bin_taxon, "percent_trans") %>%
select("complete genome size (Mbp)", "percent_trans", "log_percent_trans",
"Class with more than 10 MAGs", "depth", "Class", "percent_biofilm",
"log_percent_biofilm", "class_trans", "graphing_log_trans",
"graphing_log_biofilm") %>%
filter(!is.na(depth))
all <- all%>%  #filter_outliers(all,"complete genome size (Mbp)") %>%
mutate(size_bin=cut(`complete genome size (Mbp)`, breaks = c(0,2,3,4,5,20)))
# mutate(size_bin = cut_interval(`complete genome size (Mbp)`, 5))
all$size_bin <- as.character(all$size_bin)
all$size_bin[all$size_bin == '(0,2]'] <- '0-2'
all$size_bin[all$size_bin == '(2,3]'] <- '2-3'
all$size_bin[all$size_bin == '(3,4]'] <- '3-4'
all$size_bin[all$size_bin == '(4,5]'] <- '4-5'
all$size_bin[all$size_bin == '(5,20]'] <- '>5'
all$size_bin <- factor(all$size_bin, levels = c(">5","4-5","3-4","2-3","0-2"))
p1<-ggplot(all, aes(x=fct_rev(size_bin), y=percent_trans)) +
geom_jitter(aes(color = class_trans), alpha = 0.8) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = 0.03)) +
facet_wrap(~depth, ncol= 3) +
# labs(color='Taxonomical Classes of:') +
#coord_flip()+
ylab("%-transposase in MAG") +
xlab("complete genome size (Mbp)") +
theme_classic() +
theme(legend.position = "none")
# filter_outliers(all, "complete genome size (Mbp)")
p2<-all %>%
filter(depth %in% c("SRF", "DCM", "MES")) %>%
mutate(depth = fct_rev(depth)) %>%
ggplot(aes(x = depth, y = `complete genome size (Mbp)`)) +
# ylim(0,12.5) +
stat_compare_means(comparisons = list(c("DCM","MES"), c("SRF","MES")),
label = "p.signif", hide.ns = TRUE, method = "t.test",
label.y = c(8,9)) +
scale_color_manual(labels = c("High transposase abundance\n(\u0251- \u03b2- \u03b3- \u03b4- proteobacteria,\n Actinobactia, Sphingobactia)\n",
"Normal transposase abundance\n",
"Low transposase abundance\n(Verrucomicrobia, Acidimicrobidae)"),
values = c('orange','gray', "green"))+
labs(color='Taxonomical Class of:') +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, alpha = 0.1) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = 0.2)) +
coord_flip() +
theme_classic()
ggarrange(p1,p2,
nrow = 2,
heights = c(3/5,2/5),
labels = c("A", "B"))
all_p <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans") %>%
filter(!is.na(depth))
all_p <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans") %>%
filter(!is.na(depth))
all_p <- filter_outliers(all_p, "median_bin_pnps")
color2 <- ifelse(all_p$depth=="MES","blue4",ifelse(all_p$depth=="DCM", "steelblue", "sky blue"))
scatterplot3d(all_p[,c("median_bin_pnps", "graphing_log_trans", "depth")],
angle = 23, pch = 20, # pch = all$shape3D, # type = "h", lty.hplot = 2,
lab.z = 2,
lab = c(4, 4, 1),
y.ticklabs = c("<0.01%", "0.03%", "0.1%", "0.32%", "1%"),
# scale.y = 0.5,
z.ticklabs = c("     MES", "DCM", "SRF"),
grid=TRUE, box=TRUE, color=color2)
scale <- c(-2, -1.5, -1, -0.5, 0)
log_scale <- c("0%\nno hits", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.8) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
facet_wrap(~depth, ncol= 3) +
# labs(color='Taxonomical Classes of:') +
#coord_flip()+
ylab("%-transposase in MAG") +
xlab("complete genome size (Mbp)") +
theme_classic() +
theme(legend.position = "none")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
facet_wrap(~depth, ncol= 3) +
# labs(color='Taxonomical Classes of:') +
#coord_flip()+
ylab("%-transposase in MAG") +
xlab("complete genome size (Mbp)") +
theme_classic() +
theme(legend.position = "none")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme(legend.position = "none")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme(legend.position = "none") +
theme_classic()
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~fct_rev(depth), ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
# median_bin_pnps is normally distributed
hist(filter_outliers(bin_taxon, "median_bin_pnps")$median_bin_pnps)
all_p <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans") %>%
filter(!is.na(depth))
all_p <- filter_outliers(all_p, "median_bin_pnps")
color2 <- ifelse(all_p$depth=="MES","blue4",ifelse(all_p$depth=="DCM", "steelblue", "sky blue"))
scatterplot3d(all_p[,c("median_bin_pnps", "graphing_log_trans", "depth")],
angle = 23, pch = 20, # pch = all$shape3D, # type = "h", lty.hplot = 2,
lab.z = 2,
lab = c(4, 4, 1),
y.ticklabs = c("<0.01%", "0.03%", "0.1%", "0.32%", "1%"),
# scale.y = 0.5,
z.ticklabs = c("     MES", "DCM", "SRF"),
grid=TRUE, box=TRUE, color=color2)
scale <- c(-2, -1.5, -1, -0.5, 0)
log_scale <- c("0%\nno hits", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5, height = 0.001) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5, height = 0.01) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5, height = 0.05) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
# median_bin_pnps is normally distributed
hist(filter_outliers(bin_taxon, "median_bin_pnps")$median_bin_pnps)
all_p <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans") %>%
filter(!is.na(depth))
all_p <- filter_outliers(all_p, "median_bin_pnps")
color2 <- ifelse(all_p$depth=="MES","blue4",ifelse(all_p$depth=="DCM", "steelblue", "sky blue"))
scatterplot3d(all_p[,c("median_bin_pnps", "graphing_log_trans", "depth")],
angle = 23, pch = 20, # pch = all$shape3D, # type = "h", lty.hplot = 2,
lab.z = 2,
lab = c(4, 4, 1),
y.ticklabs = c("<0.01%", "0.03%", "0.1%", "0.32%", "1%"),
# scale.y = 0.5,
z.ticklabs = c("     MES", "DCM", "SRF"),
grid=TRUE, box=TRUE, color=color2)
scale <- c(-2.5, -2, -1.5, -1, -0.5, 0)
log_scale <- c("0%\nno hits", "0.01", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5, height = 0.05) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
# median_bin_pnps is normally distributed
hist(filter_outliers(bin_taxon, "median_bin_pnps")$median_bin_pnps)
all_p <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans") %>%
filter(!is.na(depth))
all_p <- filter_outliers(all_p, "median_bin_pnps")
color2 <- ifelse(all_p$depth=="MES","blue4",ifelse(all_p$depth=="DCM", "steelblue", "sky blue"))
scatterplot3d(all_p[,c("median_bin_pnps", "graphing_log_trans", "depth")],
angle = 23, pch = 20, # pch = all$shape3D, # type = "h", lty.hplot = 2,
lab.z = 2,
lab = c(4, 4, 1),
y.ticklabs = c("<0.01%", "0.03%", "0.1%", "0.32%", "1%"),
# scale.y = 0.5,
z.ticklabs = c("     MES", "DCM", "SRF"),
grid=TRUE, box=TRUE, color=color2)
scale <- c(-2.5, -2, -1.5, -1, -0.5, 0)
log_scale <- c("no hits", "0.01%", "0.03%", "0.10%", "0.33%", "1.0%")
all_p  %>%
ggplot(aes(y = graphing_log_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 3) +
scale_y_continuous(breaks = scale, labels = log_scale) +
xlab("Median MAG pN/pS (Tara Oceans only)") +
ylab("% of transposase ORF in MAG") +
geom_jitter(aes(color = class_trans), alpha = 0.5, height = 0.05) +
scale_color_manual(labels = c("High %-transposase", "Normal %-transposase", "Low %-transposase"),
values = c('orange','gray', "green"))+
theme_classic() +
theme(legend.position = "none")
colnames(malaspina_bins)
transposase_in_bins <- init_transposase_in_bins()
colnames(transposase_in_bins)
View(transposase_in_bins)
g(tara_bins_trans, mala_bins_trans) %=% init_transposase_in_bins()
View(mala_bins_trans)
View(tara_bins_trans)
colnames(malaspina_bins)
mala_bins_trans$bin
malaspina_bins$bin
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
malaspina_bins_trans_biofilm_TA <- read_csv("data/malaspina_biofilm_trans_TA_each_bin.csv")
malaspina_bins$bin <- gsub('mp-deep_mag-', 'deep_MAG_', malaspina_bins$magId)
malaspina_bins <- merge(malaspina_bins, pn_ps_malaspina_bins, by="bin", all.x = TRUE)
malaspina_bins <- read_csv("data/malaspina_bin_taxon.csv")
pn_ps_malaspina_bins <- read_csv("data/malaspina_bin_median_pnps.csv")
malaspina_bins_trans_biofilm_TA <- read_csv("data/malaspina_biofilm_trans_TA_each_bin.csv")
malaspina_bins$bin <- gsub('mp-deep_mag-', 'deep_MAG_', malaspina_bins$magId)
malaspina_bins <- merge(malaspina_bins, pn_ps_malaspina_bins, by="bin", all.x = TRUE)
malaspina_bins <- merge(malaspina_bins, malaspina_bins_trans_biofilm_TA, by="bin", all.x = TRUE)
malaspina_bins$percent_trans <- malaspina_bins$transposase_count / malaspina_bins$genomeSize * 100
malaspina_bins$percent_biofilm <- malaspina_bins$transposase_count / malaspina_bins$genomeSize * 100
malaspina_bins$biofilm_count
malaspina_bins$percent_trans <- malaspina_bins$transposase_count / malaspina_bins$genomeSize * 100
malaspina_bins$percent_biofilm <- malaspina_bins$biofilm_count / malaspina_bins$genomeSize * 100
malaspina_bins$log_percent_trans <- log10(malaspina_bins$percent_trans + c)
malaspina_bins$log_percent_biofilm <- log10(malaspina_bins$percent_biofilm + c)
c <- 0.0000000001 # for log(0)
low_trans <- c("Verrucomicrobia", "Acidimicrobidae")
high_trans <- c("Alphaproteobacteria", "Betaproteobacteria", "Deltaproteobacteria",
"Gammaproteobacteria", "Sphingobacteria", "Actinobacteria")
malaspina_bins$percent_trans <- malaspina_bins$transposase_count / malaspina_bins$genomeSize * 100
malaspina_bins$percent_biofilm <- malaspina_bins$biofilm_count / malaspina_bins$genomeSize * 100
malaspina_bins$log_percent_trans <- log10(malaspina_bins$percent_trans + c)
malaspina_bins$log_percent_biofilm <- log10(malaspina_bins$percent_biofilm + c)
malaspina_bins$log_median_bin_pnps <- log10(malaspina_bins$median_bin_pnps)
malaspina_bins$graphing_log_trans <- ifelse(malaspina_bins$log_percent_trans < -9, -2.5, malaspina_bins$log_percent_trans)
malaspina_bins$graphing_log_biofilm <- ifelse(malaspina_bins$log_percent_biofilm < -9, -2.5, malaspina_bins$log_percent_biofilm)
malaspina_bins$class_trans <- ifelse(malaspina_bins$Class %in% low_trans, "low",
ifelse(malaspina_bins$Class %in% high_trans, "high", "normal"))
malaspina_bins$class_trans <- factor(malaspina_bins$class_trans, levels = c("high", "normal", "low"))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
all_y <- malaspina_bins
View(all_y)
all_y <- malaspina_bins %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans") %>%
filter(!is.na(depth))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
# median_bin_pnps is normally distributed
hist(filter_outliers(bin_taxon, "median_bin_pnps")$median_bin_pnps)
all_x <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans")
all_y <- malaspina_bins %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
c <- 0.0000000001 # for log(0)
low_trans <- c("Verrucomicrobia", "Acidimicrobidae")
high_trans <- c("Alphaproteobacteria", "Betaproteobacteria", "Deltaproteobacteria",
"Gammaproteobacteria", "Sphingobacteria", "Actinobacteria")
malaspina_bins <- read_csv("data/malaspina_bin_taxon.csv")
pn_ps_malaspina_bins <- read_csv("data/malaspina_bin_median_pnps.csv")
malaspina_bins_trans_biofilm_TA <- read_csv("data/malaspina_biofilm_trans_TA_each_bin.csv")
malaspina_bins$bin <- gsub('mp-deep_mag-', 'deep_MAG_', malaspina_bins$magId)
malaspina_bins <- merge(malaspina_bins, pn_ps_malaspina_bins, by="bin", all.x = TRUE)
malaspina_bins <- merge(malaspina_bins, malaspina_bins_trans_biofilm_TA, by="bin", all.x = TRUE)
malaspina_bins$percent_trans <- malaspina_bins$transposase_count / malaspina_bins$genomeSize * 100
malaspina_bins$percent_biofilm <- malaspina_bins$biofilm_count / malaspina_bins$genomeSize * 100
malaspina_bins$log_percent_trans <- log10(malaspina_bins$percent_trans + c)
malaspina_bins$log_percent_biofilm <- log10(malaspina_bins$percent_biofilm + c)
malaspina_bins$log_median_bin_pnps <- log10(malaspina_bins$median_bin_pnps)
malaspina_bins$graphing_log_trans <- ifelse(malaspina_bins$log_percent_trans < -9, -2.5, malaspina_bins$log_percent_trans)
malaspina_bins$graphing_log_biofilm <- ifelse(malaspina_bins$log_percent_biofilm < -9, -2.5, malaspina_bins$log_percent_biofilm)
malaspina_bins$class_trans <- ifelse(malaspina_bins$Class %in% low_trans, "low",
ifelse(malaspina_bins$Class %in% high_trans, "high", "normal"))
malaspina_bins$class_trans <- factor(malaspina_bins$class_trans, levels = c("high", "normal", "low"))
malaspina_bin$depth <- "deep Malaspina"
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(bin_taxon, depth_comparisons, malaspina_bins) %=% init_bins()
all_y <- malaspina_bins %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans")
all_x <- bin_taxon %>% # filter_outliers(bin_taxon, "percent_trans") %>%
select("median_bin_pnps", "percent_trans", "log_percent_trans", "complete genome size (Mbp)",
"depth", "Class", "percent_biofilm", "log_percent_biofilm", "graphing_log_trans",
"class_trans")
