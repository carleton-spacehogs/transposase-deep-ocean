bin_to_graph <- rbind(malaspina_bins %>% select(c("median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("is_MES", "median_bin_pnps")))
bin_to_graph%>%
ggplot(x= is_MES, y = median_bin_pnps, fill=is_MES) %>%
theme_classic() +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") # +
bin_taxon %>% select(c("is_MES", "median_bin_pnps")))
bin_to_graph%>%
ggplot2(x= is_MES, y = median_bin_pnps, fill=is_MES) %>%
theme_classic() +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA)
bin_to_graph%>%
ggplot2(x= is_MES, y = median_bin_pnps, fill=is_MES) %>%
theme_classic() +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA)
bin_to_graph%>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) %>%
theme_classic() +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") # +
bin_to_graph%>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) %>%
theme_classic() +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA)
bin_to_graph%>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) %>%
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") # +
bin_to_graph%>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic()
View(bin_to_graph)
View(bin_taxon)
View(bin_taxon)
bin_to_graph <- rbind(malaspina_bins %>% select(c("median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps")))
bin_to_graph <- rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps")))
bin_to_graph%>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") # +
View(bin_to_graph)
View(bin_taxon)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
bin_to_graph <- rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps")))
bin_to_graph%>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5, 1)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16", "10")
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") # +
coord_flip()
View(malaspina_bins)
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip() #
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic()
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5) +
theme_classic()
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5) +
theme_classic() +
ylim(0, 1.5)
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5) +
theme_classic() +
ylim(0, 1.25)
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5) +
theme_classic() +
ylim(0, 1.2)
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
ylim(0, 1)
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5, 1)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16", "10")
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1))
ylim(0, 1)
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7, 0.9, 0.95)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none")
rbind(malaspina_bins %>% select(c("bin","median_bin_pnps", "is_MES")),
bin_taxon %>% select(c("bin", "is_MES", "median_bin_pnps"))) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1))
ylim(0, 1)
graph_col <- c("bin","log_median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1))
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS")
max(malaspina_bins$median_bin_pnps)
max(malaspina_bins$median_bin_pnps, na.rm = TRUE)
max(malaspina_bins$median_bin_pnps, na.rm = TRUE)
graph_col <- c("bin","median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic()
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5) +
theme_classic()
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = (0,1))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = (0,1)))
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(0,1))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(0,0.1))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2,-1))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0))
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip() #
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
label = "p.signif", hide.ns = TRUE, tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip() #
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip() #
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-2, 1)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip()
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip() #
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_MES")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01,
label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip()
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = 0)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none") +
coord_flip() #
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_fill_manual(breaks=c("Tara_trans", "SRF&DCM","MES","Deep_Malaspina", "Mala_trans"),
values=c("orange", "sky blue", "steelblue", "blue4", "orange"))+
theme(legend.position="none"
)
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_MES, y = log_median_bin_pnps, fill=is_MES)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_fill_manual(breaks=c("SRF&DCM","MES","Deep_Malaspina"),
values=c("sky blue", "steelblue", "blue4"))+
theme(legend.position="none")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "depth")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= depth, y = log_median_bin_pnps, fill=depth)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
scale_fill_manual(breaks=c("SRF&DCM","MES","Deep_Malaspina"),
values=c("sky blue", "steelblue", "blue4"))+
theme(legend.position="none") +
coord_flip() #
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(depth != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= depth, y = log_median_bin_pnps, fill=depth)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
# scale_fill_manual(breaks=c("SRF&DCM","MES","Deep_Malaspina"), values=c("sky blue", "steelblue", "blue4"))+
theme(legend.position="none") +
coord_flip()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_tara")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(is_tara != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_tara, y = log_median_bin_pnps, fill=is_tara)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
# scale_fill_manual(breaks=c("SRF&DCM","MES","Deep_Malaspina"), values=c("sky blue", "steelblue", "blue4"))+
theme(legend.position="none") +
coord_flip()
setwd(dirname(rstudioapi::getActiveDocumentContext()$path ))
source("./init_share.R")
g(pn_ps_integron, pn_ps_bins, pn_ps_total, tara_integron_summary, malaspina_integron_summary, tara_integron_all, malaspina_integron_all) %=% init_integron()
g(bin_taxon, depth_comparison, malaspina_bins) %=% init_bins()
g(trans_in_tara_bins, trans_in_mala_bins) %=% init_transposase_in_bins()
scale1 <- c(-2, -1.5, -1, -0.5, 0, 0.5)
log_scale1 <- c("<0.01", "0.03", "0.10", "0.32", "1", "3.16")
graph_col <- c("bin","log_median_bin_pnps", "is_tara")
rbind(malaspina_bins %>% select(graph_col),
bin_taxon %>% filter(is_tara != "unsure") %>% select(graph_col)) %>%
ggplot(aes(x= is_tara, y = log_median_bin_pnps, fill=is_tara)) +
geom_boxplot(alpha = 0.5, width=.5, outlier.colour = NA) +
theme_classic() +
scale_y_continuous(breaks = scale1, labels = log_scale1, name = "pN/pS", limits = c(-1.5,0)) +
stat_compare_means(comparisons = list( c("SRF&DCM", "MES"), c("Deep_Malaspina", "MES")),
tip.length = 0.01, label.y = c(-0.1,0.7)) +
stat_summary(fun.data = boxplot.give.n, geom = "text", position=position_nudge(x = 0, y = -0.7)) +
# scale_fill_manual(breaks=c("SRF&DCM","MES","Deep_Malaspina"), values=c("sky blue", "steelblue", "blue4"))+
theme(legend.position="none") +
coord_flip()
