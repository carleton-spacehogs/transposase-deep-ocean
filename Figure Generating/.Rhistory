xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
#scale_color_manual(#breaks=c('particle','mixed','planktonic'),
#  values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(#breaks=c('particle','mixed','planktonic'),
values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
#scale_color_manual(#breaks=c('particle','mixed','planktonic'),
#  values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(#breaks=c('planktonic','mixed','particle'),
values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
# scale_color_manual(values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
p2 <- all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(values=c('orange','gray', "green"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(values=c('green','gray', "orange"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
p2 <- all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(values=c('green','gray', "orange"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(0.52,0.48),labels = c("A", "B"))
ggsave("pnps_depth_bin_pnps.png", plot = last_plot())
ggsave("pnps_depth_bin_pnps.png", plot = last_plot())
p2 <- all_p %>%
ggplot(aes(y = percent_trans, x = median_bin_pnps)) +
facet_wrap(~depth, ncol = 2) +
scale_x_continuous(breaks = scale, limits=c(0, 0.65)) +
xlab("Median MAG pN/pS") +
ylab("% of transposase ORFs in MAG") +
geom_smooth(se = FALSE,method = lm) +
scale_color_manual(values=c('green','orange', "red"))+
geom_point(aes(color = size_fraction), alpha = 0.5) +
labs(color='Lifestyle') +
theme_classic()
ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(0.52,0.48),labels = c("A", "B"))
ggsave("pnps_depth_bin_pnps.png", plot = last_plot())
stat_box_data <- function(y) {
return(
data.frame(
label = paste('count =', length(y), '\n', "here")
)
)
}
pn_ps_metagenome %>%
filter(pnps < 4) %>%
ggplot(aes(x=log_pnps, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text",
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
pn_ps_metagenome %>%
filter(pnps < 4) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text",
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
pn_ps_metagenome %>%
filter(pnps < 4) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
pn_ps_metagenome %>%
filter(pnps < 4) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
)
pn_ps_metagenome %>%
filter(pnps < 4) %>%
filter(pnps > 0) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
)
df.m <- melt(pn_ps_metagenome, id.var = "depth")
df.m %>%
filter(pnps < 4) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
View(df.m)
View(pn_ps_metagenome)
df.m <- melt(pn_ps_metagenome, id.var = "depth")
melt(iris, id.var = "Species")
iris
df.m <- melt(pn_ps_metagenome, id.var = "gene_type2")
df.m <- melt(pn_ps_metagenome[,c("log_pnps", "gene_type2", "depth")],
id.var = "gene_type2")
col <- c("log_pnps", "gene_type2", "depth")
col <- c("log_pnps", "gene_type2", "depth")
df.m <- melt(pn_ps_metagenome[,col], id.var = "gene_type2")
colnames(df.m) <- col
colnames(df.m) <- c("gene_type2", "depth", "log_pnps")
df.m %>%
filter(pnps < 4) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
df.m %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
df.m %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
df.m %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic()
df.m %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
#scale_x_continuous(breaks = scale1, labels = log_scale1,
#                   name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic()
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
#scale_x_continuous(breaks = scale1, labels = log_scale1,
#                   name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic()
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
#scale_x_continuous(breaks = scale1, labels = log_scale1,
#                   name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left")
df.m$log_pnps <- as.numeric(df.m$log_pnps)
View(df.m)
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE)
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
#scale_x_continuous(breaks = scale1, labels = log_scale1,
#                   name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left")
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
facet_wrap(~depth, nrow = 4, strip.position = "left")
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
facet_wrap(~depth, nrow = 4, strip.position = "left")
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth)) +
geom_boxplot(outlier.colour = NA, notch = TRUE, fill = gene_type2) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
facet_wrap(~depth, nrow = 4, strip.position = "left")
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth)) +
geom_boxplot(outlier.colour = NA, notch = TRUE, aes(fill = gene_type2)) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
facet_wrap(~depth, nrow = 4, strip.position = "left")
stat_box_data <- function(y) {
return(
data.frame(
label = paste('count =', length(y), '\n', "here")
)
)
}
df.m[1:50,] %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, y=depth)) +
geom_boxplot(outlier.colour = NA, notch = TRUE,
aes(fill = gene_type2)) +
stat_summary(
fun.data = stat_box_data,
geom = "text"
#hjust = 0.5,
#vjust = 0.9
) +
facet_wrap(~depth, nrow = 4, strip.position = "left")
pn_ps_metagenome %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
pn_ps_metagenome %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(y=log_pnps, x=depth, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
pn_ps_metagenome %>%
filter(log_pnps < 0.63) %>%
filter(log_pnps > -3) %>%
ggplot(aes(x=log_pnps, fill = gene_type2)) +
geom_boxplot(outlier.colour = NA, notch = TRUE) +
scale_x_continuous(breaks = scale1, labels = log_scale1,
name = "pN/pS of metagenomic ORFs", limits = c(-1.5, 1)) +
theme_classic() +
facet_wrap(~depth, nrow = 4, strip.position = "left") +
guides(fill=guide_legend(title="ORF Type:",reverse = TRUE)) +
scale_fill_manual(labels = c("Transposase","Non-Transposase"),
values=c("orange","gray")) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.position = c(0.85, 0.47),
plot.margin=unit(c(0.2,0.2,0.2,0.5), "cm"),
legend.background = element_rect(fill = "transparent",
color = "transparent"))
nrwo(bin_taxin)
nrow(bin_taxin)
nrow(bin_taxon)
